class Countdown{init(url,append){let $app=append,$countdown_container,data={element_include:!0},status;$.post(url,data,data=>{append.append(data),setTimeout(()=>{$countdown_container=$(document).find("countdown"),setTimeout(()=>$countdown_container.attr("active","true"),100),url="/do/countdown/check_running";let info_card_status=!1,due_reached=this.check_countdown_due_reached();console.log("COUNTDOWN DUE REACHED:",due_reached),due_reached?setTimeout(()=>info_card_exists($app),2e3):loading_inveral=setInterval(()=>{console.log("CHECKING COUNTDOWN RUNNING..."),status=this.check_countdown_running(url,$countdown_container),status?(console.log("COUNTDOWN RUNNING:",status),this.start_countdown(),setTimeout(()=>info_card_exists($app),2e3),clearInterval(loading_inveral)):(console.log("COUNTDOWN RUNNING:",status),info_card_status||(info_card_exists($app),info_card_status=!0))},1e3)},10)})}check_countdown_running=(url,append)=>{let status=!1;return $.ajax({url:url,async:!1,dataType:"JSON",method:"GET",success:data=>{data.status&&(append.attr("active",!0),clearInterval(loading_inveral)),status=data.status},error:data=>console.error(data)}),status};check_countdown_due_reached=()=>{let url="/do/countdown/check_due_reached",status=!1;return $.ajax({url:url,method:"POST",async:!1,success:data=>{data&&(status=!0)}}),status};get_due_time=()=>{let url="/do/countdown/get_timestamps",due={};return $.ajax({url:url,async:!1,dataType:"JSON",method:"POST",success:data=>{due=data},error:data=>{console.error(data)}}),due};start_countdown=()=>{let $app=$(document).find("app"),$pyro=$(document).find(".pyro"),$output_hours=document.getElementById("countdown_hours"),$output_minutes=document.getElementById("countdown_minutes"),$output_seconds=document.getElementById("countdown_seconds"),due=this.get_due_time(),exact_due=new Date(due.due_timestamp).getTime(),x=setInterval(()=>{let now=(new Date).getTime(),distance=exact_due-now,days=Math.floor(distance/864e5),hours=Math.floor(distance%864e5/36e5),minutes=Math.floor(distance%36e5/6e4),seconds=Math.floor(distance%6e4/1e3);if(hours=hours<10?"0"+hours:hours,minutes=minutes<10?"0"+minutes:minutes,seconds=seconds<10?"0"+seconds:seconds,$output_hours.innerHTML=hours,$output_minutes.innerHTML=minutes,$output_seconds.innerHTML=seconds,distance<1){$pyro.attr("active",!0),info_card_exists($app,"Countdown is done! Let's go to LIDL!");const audioContext=new AudioContext,element=document.querySelector("audio"),source=audioContext.createMediaElementSource(element);source.connect(audioContext.destination),element.play(),$output_hours.innerHTML="LE",$output_minutes.innerHTML="TS",$output_seconds.innerHTML="GO",clearInterval(x)}},1e3);setTimeout(()=>{$(document).find("s").addClass("active")},1e3)}}let countdown=new Countdown;